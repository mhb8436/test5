configfile: "config/config.yaml"

FILENAMES = ['A','B','C']
DATA_DIR = config['data_dir']
OUTPUTS_DIR = config['outputs_dir']

rule all:
	input:
		expand("{OUTPUTS_DIR}/wc_all.png", OUTPUTS_DIR=OUTPUTS_DIR)

rule count:
	input:
		expand("{DATA_DIR}/{filename}.txt", DATA_DIR=DATA_DIR, filename=FILENAMES)
	output:
		expand("{OUTPUTS_DIR}/wc_{filename}.txt", OUTPUTS_DIR=OUTPUTS_DIR, filename=FILENAMES)
	shell:
		"wc -w {input} > {output}"

rule concat:
	input:
		expand('{OUTPUTS_DIR}/wc_{filename}.txt', filename=FILENAMES, OUTPUTS_DIR=OUTPUTS_DIR)
	output:
		expand("{OUTPUTS_DIR}/wc_all.csv", OUTPUTS_DIR=OUTPUTS_DIR)
	script:
		"scripts/concat.py"

rule plot:
	input:
		expand("{OUTPUTS_DIR}/wc_all.csv", OUTPUTS_DIR=OUTPUTS_DIR)
	output:
		expand("{OUTPUTS_DIR}/wc_all.png", OUTPUTS_DIR=OUTPUTS_DIR)
	script:
		"scripts/plot.py"

